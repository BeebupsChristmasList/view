<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beebup's Christmas List 2025</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Mountains+of+Christmas:wght@700&display=swap" rel="stylesheet">
    
    <!-- NEW: Tone.js CDN for music -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    
    <!-- Custom Tailwind Configuration -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'sans': ['Inter', 'sans-serif'],
                        'display': ['"Mountains of Christmas"', 'cursive'],
                    },
                    colors: {
                        'festive-green': '#166534', // A deep green
                        'festive-red': '#DC2626',   // A bright red
                        'festive-gold': '#FBBF24',  // A warm gold
                        'night-bg': '#111827',     // A dark blue/black
                    }
                }
            }
        }
    </script>
    
    <!-- Custom CSS for Animations and Layout -->
    <style>
        /* NEW: Custom cursor styles */
        body {
            /* Hide the default cursor on desktops */
            cursor: none;
        }
        .cursor-dot, .cursor-outline {
            display: none; /* Hidden by default, shown on md: */
            position: fixed;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 9999;
            transform: translate(-50%, -50%);
            transition: all 0.1s linear;
        }
        .cursor-dot {
            width: 8px;
            height: 8px;
            background-color: white;
            border-radius: 50%;
        }
        .cursor-outline {
            width: 40px;
            height: 40px;
            border: 2px solid white;
            border-radius: 50%;
            transition: all 0.15s ease-out;
        }
        /* Show cursor only on non-touch devices */
        @media (min-width: 768px) and (pointer: fine) {
            body {
                cursor: none;
            }
            .cursor-dot, .cursor-outline {
                display: block;
            }
        }
        /* Cursor grow effect */
        .cursor-outline.grow {
            transform: translate(-50%, -50%) scale(1.5);
            background-color: rgba(255, 255, 255, 0.1);
        }

        /* NEW: Festive text glow animation */
        @keyframes festiveGlow {
            0% { text-shadow: 0 0 3px rgba(255, 255, 255, 0.1); }
            50% { text-shadow: 0 0 8px rgba(255, 255, 255, 0.4); }
            100% { text-shadow: 0 0 3px rgba(255, 255, 255, 0.1); }
        }
        /* Apply glow to festive colors */
        .text-festive-red {
            animation: festiveGlow 2.5s infinite alternate;
        }
        .text-festive-gold {
            animation: festiveGlow 2s infinite alternate;
        }


        /* CSS-Only Snowfall Animation */
        .snowflake {
            position: absolute;
            top: -20px;
            background: white;
            border-radius: 50%;
            opacity: 0.8;
            animation: fall linear infinite;
        }
        /* Keyframes for snow are now generated by JS for randomness */


        /* Hero text fade-in */
        .hero-text {
            animation: fadeIn 2s ease-out;
            /* NEW: Add transition for smooth parallax scrolling */
            transition: opacity 0.2s linear, transform 0.2s linear;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Scroll-down chevron animation */
        .scroll-down {
            animation: bounce 2s infinite;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-15px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        /* UPDATED: Scroll-reveal animation (smoother and more subtle) */
        .reveal-item {
            opacity: 0;
            transform: translateY(20px); /* Reduced from 30px */
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
            /* NEW: Delay is now set by JS for stagger effect */
            transition-delay: var(--reveal-delay, 0s);
        }
        .reveal-item.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* NEW: 3D Tilt Card effect */
        /* Applied by JS, but 'perspective' is needed on the parent */
        .gift-grid {
            perspective: 1000px;
        }
        .gift-card {
            /* UPDATED: This transition now smooths the tilt-reset *and* the mobile :active state */
            transition: transform 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            /* NEW: Added gold border for "present" feel */
            border-top: 4px solid #FBBF24; /* festive-gold */
        }
        
        /* NEW: Style for the link, to make it fill the card */
        .gift-card-link {
            display: block;
            text-decoration: none;
            /* This makes the tilt/reveal apply to the link wrapper */
            transition: transform 0.4s cubic-bezier(0.23, 1, 0.32, 1);
        }

        /* NEW: Simple tap-to-scale effect for touch devices */
        .gift-card-link:active .gift-card {
            transform: scale(1.05);
            transition: transform 0.1s ease-out;
        }


        /* NEW: Countdown Timer Styles */
        #countdown-timer {
            text-align: center;
            margin: 4rem auto;
            max-width: 600px;
        }
        #countdown-timer .countdown-title {
            font-family: 'Mountains of Christmas', cursive;
            font-size: 2.5rem; /* 40px */
            color: #FBBF24; /* festive-gold */
        }
        .countdown-blocks {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
        }
        .countdown-block {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem 1.5rem;
            border-radius: 8px;
            min-width: 80px;
        }
        .countdown-block span {
            display: block;
        }
        .countdown-number {
            font-size: 2.25rem; /* 36px */
            font-weight: 700;
            color: white;
            line-height: 1;
        }
        .countdown-label {
            font-size: 0.875rem; /* 14px */
            color: #d1d5db; /* gray-300 */
            text-transform: uppercase;
            margin-top: 0.25rem;
        }
        
        /* NEW: Garland and Lights Styles */
        #garland-header {
            /* Using festive-green from Tailwind config */
            --garland-color: #166534; 
        }
        .garland-bough {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 40px;
            /* Creates the "bough" effect */
            background-image: radial-gradient(
                circle at 50% 0, 
                var(--garland-color) 30%, 
                transparent 30.5%
            );
            background-size: 40px 40px;
            background-repeat: repeat-x;
            background-position: 0 100%;
            opacity: 0.9;
        }
        
        .lights-container {
            position: absolute;
            top: 20px; /* Hang from the "middle" of the bough */
            left: 0;
            width: 100%;
            height: 100%;
        }

        /* Base light style, animation is added by JS */
        .light {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

    </style>
</head>
<body class="bg-night-bg font-sans text-gray-200">

    <!-- NEW: Custom Cursor Elements -->
    <div class="cursor-dot" id="cursor-dot"></div>
    <div class="cursor-outline" id="cursor-outline"></div>

    <!-- NEW: Sticky Garland Header -->
    <div id="garland-header" class="fixed top-0 left-0 w-full h-16 z-30 pointer-events-none">
        <div class="garland-bough"></div>
        <div class="lights-container">
            <!-- Lights will be added by JS -->
        </div>
    </div>

    <!-- NEW: Music Toggle Button -->
    <button id="mute-toggle" class="fixed bottom-4 right-4 z-50 p-3 bg-white/10 backdrop-blur-sm rounded-full text-white hover:bg-white/20 transition-all cursor-pointer">
        <!-- SVG for "sound off" (default) -->
        <svg id="sound-off-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .89-1.077 1.337-1.707.707L5.586 15z" />
            <path stroke-linecap="round" stroke-linejoin="round" d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2" />
        </svg>
        <!-- SVG for "sound on" (hidden) -->
        <svg id="sound-on-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15.536 8.464a5 5 0 010 7.072M8.464 15.536a5 5 0 010-7.072M12 12c0 .27.02.53.05.79M12 12A2.25 2.25 0 0114.25 14.25M12 12A2.25 2.25 0 009.75 9.75M12 12c-.27 0-.53-.02-.79-.05M12 12A2.25 2.25 0 009.75 9.75M12 12A2.25 2.25 0 0114.25 14.25m-6.364-6.364a9 9 0 0112.728 0M12 18.75a9 9 0 00-8.486-4.32m16.972 0a9 9 0 00-8.486 4.32M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .89-1.077 1.337-1.707.707L5.586 15z" />
        </svg>
    </button>


    <!-- Snowfall Container (z-0) -->
    <div class="fixed top-0 left-0 w-full h-full overflow-hidden z-0" aria-hidden="true" id="snow-container">
        <!-- Snowflakes will be added here by JavaScript -->
    </div>

    <!-- Main Content (z-10 to be above the snow, below the garland) -->
    <div class="relative z-10">

        <!-- Hero Section -->
        <header class="min-h-screen flex flex-col items-center justify-center text-center p-4 overflow-hidden pt-16">
            <!-- Added pt-16 to account for garland -->
            <div class="hero-text">
                <h1 class="font-display text-7xl md:text-9xl text-white">Beebup's</h1>
                <h2 class="font-display text-5xl md:text-7xl text-festive-red">Christmas List</h2>
            </div>
            <div class="scroll-down absolute bottom-10">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                </svg>
            </div>
        </header>


        <!-- Responsive Gift Grid Section -->
        <section 
            id="gift-grid" 
            class="gift-grid container mx-auto max-w-6xl p-4 md:p-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 md:gap-12"
        >
            <!-- Gift items will be dynamically injected here for all devices -->
        </section>

        <!-- Christmas Countdown Timer -->
        <section id="countdown-timer">
            <h2 class="countdown-title text-festive-gold">Countdown to Christmas</h2>
            <div class="countdown-blocks">
                <div class="countdown-block">
                    <span id="countdown-days" class="countdown-number">00</span>
                    <span class="countdown-label">Days</span>
                </div>
                <div class="countdown-block">
                    <span id="countdown-hours" class="countdown-number">00</span>
                    <span class="countdown-label">Hours</span>
                </div>
                <div class="countdown-block">
                    <span id="countdown-minutes" class="countdown-number">00</span>
                    <span class="countdown-label">Minutes</span>
                </div>
                <div class="countdown-block">
                    <span id="countdown-seconds" class="countdown-number">00</span>
                    <span class="countdown-label">Seconds</span>
                </div>
            </div>
            <h3 id="countdown-message" class="countdown-title text-festive-red" style="display:none; margin-top: 1rem;">Merry Christmas!</h3>
        </section>

        <!-- Footer -->
        <footer class="text-center p-8 mt-16">
            <p class="text-gray-400">Made with <span class="text-festive-red">‚ù§Ô∏è</span> and a dash of üéÑ magic.</p>
        </footer>

    </div>

    <script>
        // ------------------------------------------------------------------
        // üéÑüéÅ ATTENTION! ADD/EDIT YOUR CHRISTMAS GIFTS HERE! üéÅüéÑ
        // ------------------------------------------------------------------
        const giftList = [
            {
                name: "Cozy Wool Socks",
                price: "$25.00",
                imageUrl: "https://placehold.co/600x400/DC2626/FFFFFF?text=Wool+Socks",
                buyUrl: "https://www.amazon.com/" // Placeholder link
            },
            {
                name: "Noise-Cancelling Headphones",
                price: "$249.99",
                imageUrl: "https://placehold.co/600x400/166534/FFFFFF?text=Headphones",
                buyUrl: "https://www.amazon.com/" // Placeholder link
            },
            {
                name: "A Really Good Book",
                price: "$18.50",
                imageUrl: "https://placehold.co/600x400/FBBF24/111827?text=A+Good+Book",
                buyUrl: "https://www.amazon.com/" // Placeholder link
            },
            {
                name: "Fancy Coffee Maker",
                price: "$120.00",
                imageUrl: "https://placehold.co/600x400/e2e8f0/111827?text=Coffee+Maker",
                buyUrl: "https://www.amazon.com/" // Placeholder link
            },
            {
                name: "Lego Bonsai Tree",
                price: "$49.99",
                imageUrl: "https://placehold.co/600x400/3B82F6/FFFFFF?text=Lego+Bonsai",
                buyUrl: "https://www.amazon.com/" // Placeholder link
            },
            {
                name: "A New Plant Friend",
                price: "$35.00",
                imageUrl: "https://placehold.co/600x400/10B981/FFFFFF?text=Plant",
                buyUrl: "https://www.amazon.com/" // Placeholder link
            }
        ];
        // --- End of easy-edit section ---
        
        
        
        // --- Core Application Logic (No need to edit below) ---
        
        document.addEventListener('DOMContentLoaded', () => {
            const giftGrid = document.getElementById('gift-grid');
            const snowContainer = document.getElementById('snow-container');
            const cursorDot = document.getElementById('cursor-dot');
            const cursorOutline = document.getElementById('cursor-outline');

            // 1. Generate Gift Cards
            function renderGifts() {
                if (!giftGrid) return;
                giftGrid.innerHTML = '';
                
                giftList.forEach(gift => {
                    const cardHtml = `
                        <a 
                            href="${gift.buyUrl}"
                            target="_blank" 
                            rel="noopener noreferrer"
                            class="gift-card-link reveal-item"
                            data-tilt 
                        >
                            <div 
                                class="gift-card bg-white rounded-lg shadow-2xl w-full overflow-hidden"
                            >
                                <img 
                                    src="${gift.imageUrl}" 
                                    alt="${gift.name}" 
                                    class="w-full h-64 object-cover"
                                    onerror="this.src='https://placehold.co/600x400/6b7280/FFFFFF?text=Image+Missing'; this.onerror=null;"
                                >
                                <div class="p-5 h-1/3 flex flex-col justify-between">
                                    <h3 class="text-2xl font-bold text-gray-900">${gift.name}</h3>
                                    <p class="text-xl text-festive-green font-semibold">${gift.price}</p>
                                </div>
                            </div>
                        </a>
                    `;
                    giftGrid.insertAdjacentHTML('beforeend', cardHtml);
                });

                // After rendering, initialize new effects
                initScrollReveal();
                initMagneticTilt(); // This will now only run on non-touch devices
                initCursorHover();
            }
            
            // 2. Scroll-Reveal Effect
            function initScrollReveal() {
                const revealItems = document.querySelectorAll('.reveal-item');
                
                const observerOptions = {
                    root: null,
                    rootMargin: '0px',
                    threshold: 0.1
                };

                const observer = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('is-visible');
                            observer.unobserve(entry.target);
                        }
                    });
                }, observerOptions);

                revealItems.forEach((item, index) => {
                    item.style.setProperty('--reveal-delay', `${index * 100}ms`);
                    observer.observe(item);
                });
            }

            // 3. UPDATED: 3D "Magnetic" Tilt Effect
            function initMagneticTilt() {
                // NEW: Check for touch device
                const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
                
                // NEW: Only run tilt effect on non-touch (mouse-based) devices
                // Mobile will use the CSS :active state instead.
                if (isTouchDevice) {
                    return; 
                }
            
                const tiltItems = document.querySelectorAll('[data-tilt]');
                
                tiltItems.forEach(item => {
                    item.addEventListener('mousemove', (e) => {
                        const { clientX, clientY } = e;
                        const { left, top, width, height } = item.getBoundingClientRect();
                        
                        const x = clientX - left;
                        const y = clientY - top;
                        
                        const maxRotate = 15; 
                        
                        const rotateX = (maxRotate * ((y / height) - 0.5) * 2).toFixed(2);
                        const rotateY = (maxRotate * ((x / width) - 0.5) * -2).toFixed(2); 

                        item.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale3d(1.05, 1.05, 1.05)`;
                        item.style.transition = 'transform 0.1s linear';
                    });

                    item.addEventListener('mouseleave', () => {
                        item.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg) scale3d(1, 1, 1)';
                        item.style.transition = 'transform 0.4s cubic-bezier(0.23, 1, 0.32, 1)';
                    });
                });
            }
            
            // 4. Custom Cursor Logic
            function initCustomCursor() {
                // Don't run on touch devices
                const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
                if (isTouchDevice) return;

                window.addEventListener('mousemove', (e) => {
                    const { clientX, clientY } = e;
                    cursorDot.style.left = `${clientX}px`;
                    cursorDot.style.top = `${clientY}px`;
                    
                    cursorOutline.style.left = `${clientX}px`;
                    cursorOutline.style.top = `${clientY}px`;
                });
            }
            
            // 5. Cursor Hover Effect
            function initCursorHover() {
                // Don't run on touch devices
                const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
                if (isTouchDevice) return;
            
                const tiltItems = document.querySelectorAll('[data-tilt]');
                tiltItems.forEach(item => {
                    item.addEventListener('mouseenter', () => {
                        cursorOutline.classList.add('grow');
                    });
                    item.addEventListener('mouseleave', () => {
                        cursorOutline.classList.remove('grow');
                    });
                });
            }

            // 6. Create Snowflakes
            function createSnowflakes() {
                if (!snowContainer) return;
                const flakeCount = 50;
                for (let i = 0; i < flakeCount; i++) {
                    const flake = document.createElement('div');
                    flake.className = 'snowflake';
                    
                    const size = Math.random() * 5 + 2;
                    flake.style.width = `${size}px`;
                    flake.style.height = `${size}px`;
                    flake.style.left = `${Math.random() * 100}vw`;
                    
                    const duration = Math.random() * 5 + 5;
                    const delay = Math.random() * 5;
                    
                    flake.style.animationDuration = `${duration}s`;
                    flake.style.animationDelay = `${delay}s`;
                    
                    const horizontalDrift = (Math.random() - 0.5) * 10;
                    flake.style.animationName = `fall-${i}`;
                    
                    const keyframes = `
                        @keyframes fall-${i} {
                            0% { transform: translateY(-5vh) translateX(0vw); opacity: 0.8; }
                            100% { transform: translateY(105vh) translateX(${horizontalDrift}vw); opacity: 0.5; }
                        }
                    `;
                    
                    if (!document.getElementById(`snow-style-${i}`)) {
                        const styleSheet = document.createElement("style");
                        styleSheet.id = `snow-style-${i}`;
                        styleSheet.innerText = keyframes;
                        document.head.appendChild(styleSheet);
                    }
                    
                    snowContainer.appendChild(flake);
                }
            }
            
            // 7. Parallax Hero Effect
            function handleScroll() {
                const heroText = document.querySelector('.hero-text');
                const heroHeader = heroText ? heroText.closest('header') : null;
                
                if (heroText && heroHeader) {
                    const scrollY = window.scrollY;
                    const heroHeight = heroHeader.offsetHeight;
                    
                    if (scrollY < heroHeight) {
                        const progress = scrollY / heroHeight;
                        heroText.style.transform = `translateY(${scrollY * 0.4}px)`;
                        heroText.style.opacity = (1 - progress).toString();
                    }
                }
            }

            // 8. Christmas Countdown Timer Logic
            function initCountdown() {
                const daysEl = document.getElementById('countdown-days');
                const hoursEl = document.getElementById('countdown-hours');
                const minutesEl = document.getElementById('countdown-minutes');
                const secondsEl = document.getElementById('countdown-seconds');
                const timerContainer = document.querySelector('.countdown-blocks'); // Changed selector
                const messageEl = document.getElementById('countdown-message');
                
                const currentYear = new Date().getFullYear();
                const christmasDay = new Date(`December 25, ${currentYear} 00:00:00`).getTime();

                function updateCountdown() {
                    const now = new Date().getTime();
                    const distance = christmasDay - now;

                    if (distance < 0) {
                        if (timerContainer) timerContainer.style.display = 'none';
                        if (messageEl) messageEl.style.display = 'block';
                        clearInterval(countdownInterval);
                        return;
                    }

                    const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                    if (daysEl) daysEl.innerText = days.toString().padStart(2, '0');
                    if (hoursEl) hoursEl.innerText = hours.toString().padStart(2, '0');
                    if (minutesEl) minutesEl.innerText = minutes.toString().padStart(2, '0');
                    if (secondsEl) secondsEl.innerText = seconds.toString().padStart(2, '0');
                }

                updateCountdown();
                const countdownInterval = setInterval(updateCountdown, 1000);
            }
            
            // 9. NEW: Garland Lights Logic
            function initGarlandLights() {
                const lightsContainer = document.querySelector('.lights-container');
                if (!lightsContainer) return;

                const lightCount = Math.floor(window.innerWidth / 50); // ~1 light every 50px
                const colors = ['#DC2626', '#FBBF24', '#3B82F6', '#10B981']; // red, gold, blue, green

                for (let i = 0; i < lightCount; i++) {
                    const light = document.createElement('span');
                    light.className = 'light';
                    
                    const color = colors[i % colors.length];
                    light.style.backgroundColor = color;
                    
                    // Add the "glow" via box-shadow in the animation
                    const glowKeyframes = `
                        @keyframes blink-${i} {
                            0%, 100% { 
                                opacity: 0.5; 
                                box-shadow: 0 0 3px ${color}, 0 0 5px ${color};
                            }
                            50% { 
                                opacity: 1; 
                                box-shadow: 0 0 8px ${color}, 0 0 12px ${color};
                            }
                        }
                    `;
                    
                    const styleSheet = document.createElement("style");
                    styleSheet.id = `light-style-${i}`;
                    styleSheet.innerText = glowKeyframes;
                    document.head.appendChild(styleSheet);
                    
                    light.style.animationName = `blink-${i}`;
                    
                    // Random animation delay + duration for twinkling
                    light.style.animationDelay = `${Math.random() * 2}s`;
                    light.style.animationDuration = `${Math.random() * 1 + 1.5}s`; // 1.5s - 2.5s
                    light.style.animationIterationCount = 'infinite';

                    // Random position
                    light.style.left = `${Math.random() * 98 + 1}%`; // 1% to 99%
                    light.style.top = `${Math.random() * 10 + 5}px`; // 5px to 15px
                    
                    lightsContainer.appendChild(light);
                }
            }
            
            // 10. NEW: Music Logic
            function initMusic() {
                try {
                    const muteToggle = document.getElementById('mute-toggle');
                    const soundOnIcon = document.getElementById('sound-on-icon');
                    const soundOffIcon = document.getElementById('sound-off-icon');
                    if (!muteToggle || !soundOnIcon || !soundOffIcon) return;
                    
                    let audioStarted = false;

                    const synth = new Tone.Synth({
                        oscillator: { type: 'triangle8' },
                        envelope: { attack: 0.02, decay: 0.1, sustain: 0.3, release: 1 }
                    }).toDestination();

                    const melody = [
                        ['E4', '8n'], ['E4', '8n'], ['E4', '4n'],
                        ['E4', '8n'], ['E4', '8n'], ['E4', '4n'],
                        ['E4', '8n'], ['G4', '8n'], ['C4', '4n'], ['D4', '4n'],
                        ['E4', '2n'],
                        ['F4', '8n'], ['F4', '8n'], ['F4', '8n'], ['F4', '8n'],
                        ['F4', '8n'], ['E4', '8n'], ['E4', '8n'], ['E4', '8n'],
                        ['E4', '8n'], ['D4', '8n'], ['D4', '8n'], ['E4', '8n'],
                        ['D4', '4n'], ['G4', '4n'],
                        ['E4', '8n'], ['E4', '8n'], ['E4', '4n'],
                        ['E4', '8n'], ['E4', '8n'], ['E4', '4n'],
                        ['E4', '8n'], ['G4', '8n'], ['C4', '4n'], ['D4', '4n'],
                        ['E4', '2n'],
                        ['F4', '8n'], ['F4', '8n'], ['F4', '8n'], ['F4', '8n'],
                        ['F4', '8n'], ['E4', '8n'], ['E4', '8n'], ['E4', '8n'],
                        ['G4', '8n'], ['G4', '8n'], ['F4', '8n'], ['D4', '8n'],
                        ['C4', '2n'],
                    ];

                    const sequence = new Tone.Sequence((time, note) => {
                        synth.triggerAttackRelease(note, '8n', time);
                    }, melody, '4n'); 

                    Tone.Transport.bpm.value = 110;
                    sequence.loop = true;

                    muteToggle.addEventListener('click', async () => {
                        if (!audioStarted) {
                            await Tone.start();
                            audioStarted = true;
                        }

                        if (Tone.Transport.state === 'started') {
                            Tone.Transport.stop();
                            sequence.stop();
                            soundOnIcon.classList.add('hidden');
                            soundOffIcon.classList.remove('hidden');
                        } else {
                            Tone.Transport.start();
                            sequence.start(0);
                            soundOnIcon.classList.remove('hidden');
                            soundOffIcon.classList.add('hidden');
                        }
                    });
                } catch (e) {
                    console.error("Tone.js failed to initialize:", e);
                    // Hide the mute button if Tone.js fails
                    const muteToggle = document.getElementById('mute-toggle');
                    if (muteToggle) muteToggle.style.display = 'none';
                }
            }
            
            // Run all initialization functions
            renderGifts();
            initCustomCursor();
            createSnowflakes();
            initCountdown();
            initGarlandLights(); // NEW
            initMusic(); // NEW
            
            // Add the scroll listener
            window.addEventListener('scroll', handleScroll);
        });
    </script>

</body>
</html>
